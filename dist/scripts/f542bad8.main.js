"use strict";var Handlebars=window.Handlebars?window.Handlebars:!1,_=window._?window._:!1;if(!_||!Handlebars)throw new Error("Handlebars or lodash / underscrore not included. Quitting now");var mc=mc?mc:{};mc.probabilityForAndOr=.2,mc.version="1",mc.types=["thing","action","logic","trigger"],mc.state={thing:{thing1:0},action:{action1:0},logic:{logic1:0},trigger:{trigger1:0}},$(document).ready(function(){var a=$("#item-template").html(),b=$("#cta-template").html(),c=Handlebars.compile(a),d=Handlebars.compile(b),e={},f=function(){_.each(mc.types,function(a){e[a]=g(a)}),$(".mc-content").html(d(e)),n()},g=function(a){var b={type:a,id1:a+"1",content1:mc.data[a][mc.state[a][a+"1"]],isConnector:void 0===mc.state[a].connector?!1:!0,connector:mc.data.connector[mc.state[a].connector],id2:a+"2",content2:mc.data[a][mc.state[a][a+"2"]]};return c(b)},h=function(a,b){var c=Math.random();if(c>mc.probabilityForAndOr)return a;for(var d=_.random(0,mc.data.connector.length-1),e=_.random(0,mc.data[b].length-1);e===a[b+"1"];)e=_.random(0,mc.data[b].length-1);return a.connector=d,a[b+"2"]=e,a},i=function(){var a={};_.each(mc.types,function(b){a[b]={},a[b][b+"1"]=_.random(0,mc.data[b].length-1)}),a.action=h(a.action,"action"),a.trigger=h(a.trigger,"trigger"),mc.state=a},j=function(a){var b=a.closest(".mc-group");if(b){var c=b.attr("data-mcType"),d=a.attr("data-mcType"),e=a.attr("id"),f=mc.state[c];e||(e="connector"),f[e]++,f[e]>mc.data[d].length-1&&(f[e]=0),mc.state[c]=f}},k=function(a){var b=window.location.hash;if(!b)return 0;try{b=window.atob(window.location.hash.split("#")[1])}catch(c){return 0}var d=new RegExp("[?&]"+a+"=([^&#]*)").exec(b);return null===d?null:d[1]||0},l=function(){var a=k("v");if(a===mc.version){var b;_.each(mc.types,function(a){if(b=k(a)){var c=b.split("+"),d=3===c.length;d?m(a,c[0])&&m(a,c[2])&&m("connector",c[1])?(mc.state[a][a+"1"]=c[0],mc.state[a][a+"2"]=c[2],mc.state[a].connector=c[1]):mc.state[a][a+"1"]=0:m(a,b)&&(mc.state[a][a+"1"]=b)}})}},m=function(a,b){var c=!0;return isNaN(b)&&(c=!1),mc.data[a].length<=b&&(c=!1),0>b&&(c=!1),c},n=function(){var a="/?v="+mc.version;_.each(mc.types,function(b){a+="&"+b+"="+mc.state[b][b+"1"],mc.state[b][b+"2"]&&(a+="+"+mc.state[b].connector+"+"+mc.state[b][b+"2"])}),a=window.btoa(a),window.location.hash=a,$("#shareUrlInputField").val(window.location.protocol+"//"+window.location.host+"/#"+a)},o=function(){$("#next-button").on("click",p),$("#share-button").on("click",function(a){a.preventDefault(),$("#shareModal").foundation("reveal","open"),setTimeout(function(){$("#shareUrlInputField").select()},300)}),$("#buttonCloseShareModal").on("click",function(){$("#shareModal").foundation("reveal","close")}),$("body").on("click",".mc-item",function(a){j($(a.target)),f()})},p=function(){i(),f()};o(),l(),f()});var mc=mc?mc:{};mc.data=mc.data?mc.data:{},mc.data.logic=["when","if","unless","as soon as","if there is a chance that"];var mc=mc?mc:{};mc.data=mc.data?mc.data:{},mc.data.thing=["web service","mobile app","toaster","fridge","device","wearable device","musical instrument","vehicle","toy","book","kitchen appliance","vending machine","rocket","ball","box","TV set","social network"];var mc=mc?mc:{};mc.data=mc.data?mc.data:{},mc.data.trigger=["you push a button","somebody comes in","it's wet","it gets dark","it starts raining","people smile","people laugh","sun rises","it gets loud","it starts snowing","somebody pushes a button","there is a fire","somebody tweets about something","sun sets","you get a call","your post gets 5 new likes","it gets too hot","a certain word is said","somebody swears","air quality gets too bad","nobody is around","somebody turns on the TV","it gets too cold"];var mc=mc?mc:{};mc.data=mc.data?mc.data:{},mc.data.action=["suggests random ideas","makes a sound","vibrates","plays a song","wakes you up","sends you a notification","tells a joke","feeds your pet","opens the door","turns itself on","registers in a google spreadhseet","lights up","prints a little message","opens the windows","turns itself off","barks","calls the police","notifies your relatives","self-destroys","sends you an SMS","takes a picture","dispenses a candy","orders beer","orders pizza"];var mc=mc?mc:{};mc.data=mc.data?mc.data:{},mc.data.connector=["and","or"];